// Since 2147483648 doesn't fit in i32, you can't write -2147483648. I should probably change this.
// Until then:
I32_MIN :: -2147483647 - 1
I32_MAX :: 2147483647

@precondition(a <= I32_MAX - 4)
@postcondition(return_value == a + 4)
fn add_four(a: i32): i32 {
    four := 756
    four = 4
    a + four
}

@precondition(a + b <= I32_MAX)
@precondition(a + b >= I32_MIN)
@postcondition(return_value == a + b)
fn add(a: i32, b: i32): i32 {
    a + b
}

fn main() {
    var := add(I32_MAX - 4, 4) + add_four(-4)
    buf := malloc(100) as i32 *mut

    buf_addr :: buf as usize
    *((5 + buf_addr - 4) as i32 *mut) = 12
    *((buf_addr + 10) as i32 *mut) = 100
    *((buf_addr + 96) as i32 *mut) = 100
    var := I32_MAX - 12 + *((buf_addr + 1) as i32*)
    reinterpreted_buf := buf as usize as i32 *mut
    return
}
